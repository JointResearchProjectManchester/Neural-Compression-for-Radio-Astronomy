Starting training...
Shape of images before processing: torch.Size([4, 1, 1, 150, 150])
Traceback (most recent call last):
  File "/share/nas2_3/adey/github/Neural-Compression-for-Radio-Astronomy/vqvae/main_autoencoder_option4.py", line 189, in <module>
    loss = mvg_nll_block(correlation_matrix, images_flat, recon_flat, n)
  File "/share/nas2_3/adey/github/Neural-Compression-for-Radio-Astronomy/vqvae/NLL_block_diag.py", line 9, in mvg_nll_block
    B = cov[:n,:n].to(device)
NameError: name 'device' is not defined